# Test: byte buffer operations for self-hosting
def test_bytes_append() -> int:
    let buf: [int] = bytes_new(0)
    bytes_append(buf, 65)
    bytes_append(buf, 66)
    bytes_append(buf, 67)
    if bytes_len(buf) == 3:
        if buf[0] == 65:
            print("PASS bytes_append")
            return 0
    print("FAIL bytes_append")
    return 1

def test_bytes_write_u16() -> int:
    let buf: [int] = bytes_new(0)
    bytes_write_u16(buf, 4660)
    if bytes_len(buf) == 2:
        let val: int = bytes_read_u16(buf, 0)
        if val == 4660:
            print("PASS bytes_write_u16")
            return 0
    print("FAIL bytes_write_u16")
    return 1

def test_bytes_write_u32() -> int:
    let buf: [int] = bytes_new(0)
    bytes_write_u32(buf, 3735928559)
    if bytes_len(buf) == 4:
        let val: int = bytes_read_u32(buf, 0)
        if val == 3735928559:
            print("PASS bytes_write_u32")
            return 0
    print("FAIL bytes_write_u32")
    return 1

def test_bytes_write_i64() -> int:
    let buf: [int] = bytes_new(0)
    bytes_write_i64(buf, 1234567890123)
    if bytes_len(buf) == 8:
        let val: int = bytes_read_i64(buf, 0)
        if val == 1234567890123:
            print("PASS bytes_write_i64")
            return 0
    print("FAIL bytes_write_i64")
    return 1

def test_bytes_roundtrip() -> int:
    let buf: [int] = bytes_new(0)
    bytes_write_u16(buf, 42)
    bytes_write_u32(buf, 100000)
    bytes_write_i64(buf, -999)
    let v1: int = bytes_read_u16(buf, 0)
    let v2: int = bytes_read_u32(buf, 2)
    let v3: int = bytes_read_i64(buf, 6)
    if v1 == 42:
        if v2 == 100000:
            if v3 == -999:
                print("PASS bytes_roundtrip")
                return 0
    print("FAIL bytes_roundtrip")
    return 1

def main() -> int:
    test_bytes_append()
    test_bytes_write_u16()
    test_bytes_write_u32()
    test_bytes_write_i64()
    test_bytes_roundtrip()
    return 0
